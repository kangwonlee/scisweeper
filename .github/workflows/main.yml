name: Python package

on: [push]

jobs:
  run: 
    runs-on: ${{ matrix.operating-system }}
    strategy:
      max-parallel: 4
      matrix:
        operating-system: [ubuntu-latest]
        python-version: [2.7, 3.6, 3.7]
    steps:
    - uses: actions/checkout@v1
    - name: install dependencies and test
      env:
        PYVER: ${{ matrix.python-version }}
      run: |
        export PATH="$CONDA/bin:$PATH"
        conda init bash
        . ~/.bashrc
        conda update -q conda
        conda create -n scisweeper -q --yes -c conda-forge coverage pandas scandir h5io numpy pysqa tqdm pip python=${PYVER}
        conda activate scisweeper
        pip install --pre .
        conda list
        coverage run -m unittest discover tests
